<div class="quiz-container">

  <div class="content">
    <mat-toolbar>
      <span>Quiz {{ quiz?.title }}</span>
    </mat-toolbar>

    <mat-card *ngIf="quiz?.questions && quiz.questions.length > 0; else noQuestions">
      <mat-card-header>
        <mat-card-title>
          Question {{ currentQuestionIndex + 1 }} / {{ quiz?.questions.length }}
        </mat-card-title>
        <mat-card-subtitle *ngIf="hasAnswered">
          Réponse: {{ quiz.questions[currentQuestionIndex].correctAnswer }}
        </mat-card-subtitle>
        <mat-card-subtitle *ngIf="!hasAnswered">
          Veuillez répondre à la question actuelle.
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <p>{{ quiz.questions[currentQuestionIndex].text }}</p>

        <mat-list>
          <mat-list-item *ngFor="let answer of quiz.questions[currentQuestionIndex].answers">
            <button mat-raised-button [ngClass]="{
                'correct': answerStates[answer.id] === true,
                'incorrect': answerStates[answer.id] === false
              }" (click)="checkAnswer(quiz.questions[currentQuestionIndex], answer.id)"
              [disabled]="answerStates[answer.id] != null">
              {{ answer.text }}
            </button>
          </mat-list-item>
        </mat-list>
      </mat-card-content>

      <mat-card-actions class="navigation">
        <button mat-raised-button color="primary" (click)="nextQuestion()" [disabled]="!hasAnswered"
          *ngIf="currentQuestionIndex < quiz.questions.length - 1">
          Question suivante
        </button>

        <button mat-raised-button color="primary" (click)="finishQuiz()"
          *ngIf="currentQuestionIndex === quiz.questions.length - 1 && hasAnswered">
          Terminer
        </button>
      </mat-card-actions>
    </mat-card>

    <ng-template #noQuestions>
      <p>Aucune question disponible.</p>
    </ng-template>
  </div>
</div>